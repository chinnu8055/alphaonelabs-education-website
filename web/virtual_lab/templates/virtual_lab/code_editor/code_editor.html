{# templates/virtual_lab/code_editor/code_editor.html #}
{% extends 'virtual_lab/layout.html' %}

{% load static %}

{% block title %}
  Code Editor – Alpha Science Lab
{% endblock title %}
{% block extra_head %}
  <!-- Ace Editor (via CDN) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.11.2/ace.js"></script>
  <style>
      #editor {
          height: 400px;
          width: 100%;
          border: 1px solid #ccc;
          background-color: #f5f5f5;
      }

      /* Dark mode styles for Ace editor */
      html.dark #editor {
          background-color: #374151;
          color: #e5e7eb;
      }

      html.dark .ace_editor {
          background-color: #374151 !important;
          color: #e5e7eb !important;
      }

      html.dark .ace_gutter {
          background-color: #1f2937 !important;
          color: #9ca3af !important;
      }
  </style>
{% endblock extra_head %}
{% block virtual_lab_content %}
  <div class="max-w-4xl mx-auto py-8">
    <h1 class="text-2xl font-bold mb-4 dark:text-gray-100">Interactive Code Editor</h1>
    <!-- Editor -->
    <div id="editor">print("Hello, world!")</div>
    <!-- Language selector -->
    <div class="mt-4 mb-2">
      <label for="language-select" class="dark:text-gray-300">Language:</label>
      <select id="language-select"
              class="border px-2 py-1 rounded dark:bg-gray-700 dark:text-gray-100 dark:border-gray-600">
        <option value="python" selected>Python</option>
        <option value="javascript">JavaScript</option>
        <option value="c">C</option>
        <option value="cpp">C++</option>
      </select>
    </div>
    <!-- stdin input -->
    <div class="mt-2">
      <label for="stdin-input" class="block mb-1 dark:text-gray-300">Custom Input:</label>
      <textarea id="stdin-input"
                rows="4"
                class="w-full border rounded p-2 font-mono dark:bg-gray-700 dark:text-gray-100 dark:border-gray-600"
                placeholder="Enter input here…"></textarea>
    </div>
    <!-- Run button -->
    <div class="mt-3">
      <button id="run-btn"
              class="px-4 py-2 bg-blue-600 dark:bg-blue-700 text-white rounded hover:bg-blue-700 dark:hover:bg-blue-800">
        Run Code
      </button>
    </div>
    <!-- Output -->
    <div class="mt-4">
      <h2 class="font-semibold mb-1 dark:text-gray-100">Output:</h2>
      <pre id="output"
           class="bg-gray-100 dark:bg-gray-700 dark:text-gray-100 p-4 rounded whitespace-pre-wrap"></pre>
    </div>
  </div>
{% endblock virtual_lab_content %}
{% block extra_scripts %}
  <script>
      window.EVALUATE_CODE_URL = "{% url 'virtual_lab:evaluate_code' %}";
      console.log('▶️ Piston endpoint:', window.EVALUATE_CODE_URL);
  </script>
  <script src="{% static 'virtual_lab/js/code_editor.js' %}"></script>
{% endblock extra_scripts %}
